
xc = xcorr(planes(1,xoff:end-xoff,1,1),zstack(1,:,1,1),[]); 

%%

% Example usage

pixelShiftRange = 30;  % Define the range for the shift in x and y directions

[bestZIndex, xShift, yShift] = findClosestRowWithShift(planes(:,:,3,2), zstack(:,:,2,:), pixelShiftRange);

%% 

